## EMR에서 텍스트 processing 코드 잘 작동하는지 확인하기

1. 텍스트 전처리 코드 s3에 업로드하기  
```bash  
./deploy.sh {python_file_name}
```  
2. AWS EMR 생성하기  

3. submit-job.sh 안에 생성한 emr 클러스터 ID로 변경하기    

4. 스크립트로 spark job submit하기  
```bash  
./submit-job.sh '싼타페' '2025-01' 
``` 

5. 결과확인
s3://{bucket_name}/{차종}/{년}/{월}/post_data

+--------------------+----------------------------------+------------------------------------+----------------------------------+----------+--------+-----------+--------+-----------+--------+-------+
|             post_id|                             title|                              author|                           article| timestamp|like_cnt|dislike_cnt|view_cnt|comment_cnt|car_name| source|
+--------------------+----------------------------------+------------------------------------+----------------------------------+----------+--------+-----------+--------+-----------+--------+-------+
|69971805-67e5-4e4...|      그랜저GN7 HDA2 차로유지보...|                            초심불멸|                                  |1737844552|     184|          0|   46507|         21|  그랜저|youtube|
|ee21afb1-cd4e-4d6...| 너무 멋진 현대자동차 신형 그랜...|                         Virtual Now| 너무 멋진 현대자동차 신형 그랜...|1736038839|     248|          0|   46216|         31|  그랜저|youtube|
|27e576f9-f617-44b...|          연비가 28.2 km/L???어...|                          모터그래프|     ♥구독은 큰 힘이 됩니다 : h...|1736204424|       0|          0|   45460|        331|  그랜저|youtube|
|a2ae3c23-feb4-4ae...|대한민국에서 각그랜져를 찾을수 ...|                              찾는놈|                                  |1738292455|    1671|          0|   45682|        303|  그랜저|youtube|
|d3fc5049-84aa-487...|                         XG의 탄생|                             가SOL린|     #현대자동차 #그랜저 #그랜저XG|1737274990|    1478|          0|   43848|         65|  그랜저|youtube|
|fd862d1b-34c3-4d3...|그랜저 페이스리프트! 방향지시등...|              뉴욕맘모스 l NYMammoth| 안녕하세요, 뉴욕맘모스입니다!\...|1736481984|     313|          0|   42240|        130|  그랜저|youtube|
|0ca2f929-83f0-48f...|  결국 실제로 겪은 현대차 정비 ...|            김승현 안피디의 스포일러|여러분의 구독과 좋아요는 콘텐츠...|1738141229|     899|          0|   39996|        191|  그랜저|youtube|
|18d03c1f-650a-479...|         "chill"세대 그랜저 GN"...|                             가SOL린|        #현대자동차 #그랜저 #chill|1736498693|    1341|          0|   38615|         63|  그랜저|youtube|
|ec94313d-4770-4e4...|           구급차 길막 그랜저 차주|                              카모아|                                  |1737018667|     508|          0|   37579|        191|  그랜저|youtube|
|80872004-be00-467...|      그랜저 HG 로워암 교체#aut...|수리왕 이과장(뭐든지 고친다)자가정비|                                  |1737120935|     114|          0|   39139|         33|  그랜저|youtube|
|97d75838-b054-4ec...|      그랜저GN7 HDA2 차로유지보...|                            초심불멸|                                  |1737844552|     184|          0|   46507|         21|  그랜저|youtube|
|27a70596-65ec-4ac...| 너무 멋진 현대자동차 신형 그랜...|                         Virtual Now| 너무 멋진 현대자동차 신형 그랜...|1736038839|     248|          0|   46216|         31|  그랜저|youtube|
|8aa78b43-b3f4-464...|          연비가 28.2 km/L???어...|                          모터그래프|     ♥구독은 큰 힘이 됩니다 : h...|1736204424|       0|          0|   45460|        331|  그랜저|youtube|
|ecf376f2-5408-4a7...|대한민국에서 각그랜져를 찾을수 ...|                              찾는놈|                                  |1738292455|    1671|          0|   45682|        303|  그랜저|youtube|
|11872392-9791-418...|                         XG의 탄생|                             가SOL린|     #현대자동차 #그랜저 #그랜저XG|1737274990|    1478|          0|   43848|         65|  그랜저|youtube|
|11a7dc2d-d5df-4ef...|그랜저 페이스리프트! 방향지시등...|              뉴욕맘모스 l NYMammoth| 안녕하세요, 뉴욕맘모스입니다!\...|1736481984|     313|          0|   42240|        130|  그랜저|youtube|
|e6bcc4fd-c6c9-45a...|  결국 실제로 겪은 현대차 정비 ...|            김승현 안피디의 스포일러|여러분의 구독과 좋아요는 콘텐츠...|1738141229|     899|          0|   39996|        191|  그랜저|youtube|
|0672cea6-b82c-4c3...|         "chill"세대 그랜저 GN"...|                             가SOL린|        #현대자동차 #그랜저 #chill|1736498693|    1341|          0|   38615|         63|  그랜저|youtube|
|bbd31f7a-2599-41f...|           구급차 길막 그랜저 차주|                              카모아|                                  |1737018667|     508|          0|   37579|        191|  그랜저|youtube|
|9483ab85-6219-421...|      그랜저 HG 로워암 교체#aut...|수리왕 이과장(뭐든지 고친다)자가정비|                                  |1737120935|     114|          0|   39139|         33|  그랜저|youtube|
+--------------------+----------------------------------+------------------------------------+----------------------------------+----------+--------+-----------+--------+-----------+--------+-------+

s3://{bucket_name}/{차종}/{년}/{월}/comment_data
+--------------------+----------------+----------------------------------+----------+--------+-----------+--------------------+
|          comment_id|          author|                           content| timestamp|like_cnt|dislike_cnt|             post_id|
+--------------------+----------------+----------------------------------+----------+--------+-----------+--------------------+
|2e8a56ad-5479-4fe...|       @영원-o6i|               앞으론 사륜 사세요ᆢ|1739262966|       1|          0|7092fdf6-bcdd-495...|
|f392fb81-f3b9-41f...|    @radiotracer|  옆에 제설함이 떡하니 있는데. ...|1739435766|       1|          0|7092fdf6-bcdd-495...|
|376ba55b-bc7a-4ed...|    @니내아나oio|            월동장비미리준비좀해라|1739522166|       1|          0|7092fdf6-bcdd-495...|
|e0648ed0-862c-4a8...|     @바사라-v9x|불스원 스프레이체인도 쓸만해요....|1738830966|       1|          0|7092fdf6-bcdd-495...|
|52e48a77-ed1a-4d0...|@남매YOUTUBE-x7h|   저희부모님댁도 임실인데 😢😢...|1738917366|       3|          0|7092fdf6-bcdd-495...|
|dbef0677-ee90-44f...|        @hkh5817|하부닿아서 체인해도 힘들텐데 대...|1738658166|       2|          0|7092fdf6-bcdd-495...|
|c72036de-154e-4fd...|        @ksc5857|      헐...체인해도 밀리신건가요??|1738571766|       3|          0|7092fdf6-bcdd-495...|
|76181a1a-9f27-499...|     @Bigegg-t8n|         속도가 조금 더 있었으면..|1738571766|       1|          0|7092fdf6-bcdd-495...|
|34b93ae7-c7b2-489...|        @kf-2150| 윈터타이어 하나 장만하세요\n사...|1739003766|       1|          0|7092fdf6-bcdd-495...|
|d6101e1d-ffea-4cf...|     @아란야-g3i|                 멈추면 않되요ㅠㅠ|1738571766|       1|          0|7092fdf6-bcdd-495...|
|3bd7c00f-3c14-47d...|    @skidrow1400|                   멈추면 끝입니다|1739003766|       1|          0|7092fdf6-bcdd-495...|
|4aeafba0-9e5b-47b...|        @jy42745|                         풀악셀!!!|1739176566|       1|          0|7092fdf6-bcdd-495...|
|6718a57d-b900-44f...|       @소원튜브|                              그래|1739608566|       0|          0|7092fdf6-bcdd-495...|
|eb96b24d-9e48-4bc...|       @소원튜브|다른차에 넣어둔걸 깜빡하고 안챙...|1739090166|       0|          0|7092fdf6-bcdd-495...|
|a7e70192-a18e-462...|       @소원튜브|할머니댁에서 오랜만에 폭설을 느...|1739090167|       0|          0|7092fdf6-bcdd-495...|
|6816b38f-ea9a-4e6...|       @소원튜브|     설경은 정말 멋지긴했습니다!😄|1738744567|       0|          0|7092fdf6-bcdd-495...|
|567418c8-3793-499...|       @소원튜브|   체인달고 밀어서 겨우 올라갔네요|1738571767|       0|          0|7092fdf6-bcdd-495...|
|3e91d475-c64f-420...|  @j.wbmwgst-max|   체인 단 소리가 아닌데? 체인 ...|1738571767|       0|          0|7092fdf6-bcdd-495...|
|4b5b57ae-1a7a-496...|       @소원튜브|               @j.wbmwgst-max  ...|1738571767|       0|          0|7092fdf6-bcdd-495...|
|8eaf15ca-fd97-499...|       @소원튜브|                                😂|1738744568|       0|          0|7092fdf6-bcdd-495...|
+--------------------+----------------+----------------------------------+----------+--------+-----------+--------------------+

s3://{bucket_name}/{차종}/{년}/{월}/sentence_data
+--------------------+----+----------------------------------+--------------------+----------+
|         sentence_id|type|                              text|             post_id|comment_id|
+--------------------+----+----------------------------------+--------------------+----------+
|0884a9ec-76be-4b8...|post|      그랜저 vs 제네시스 g80 주...|cc10c0e8-6264-463...|      NULL|
|00e13739-d64f-45a...|post|    80년대에 그랜저 타면 '진짜 ...|215b197d-be59-4ec...|      NULL|
|7d37c6a3-9321-4cd...|post|    80년대에 그랜저 타면 '진짜 ...|9ce6e5ad-0f81-472...|      NULL|
|906c849f-9601-447...|post|그랜저에 팰리세이드 외관을 적용...|a41d0a04-be29-425...|      NULL|
|65570121-2155-477...|post|시승기그랜저 하이브리드와 같은 ...|02ffff68-7c80-42f...|      NULL|
|1b0158e8-4448-4c9...|post|그랜저에 팰리세이드 외관을 적용...|d3e96d3d-37ba-416...|      NULL|
|1241b03a-f012-468...|post|          현시점 가성비 최고의 차?|ee58d62e-1a1d-4b0...|      NULL|
|0a4dbdfc-9078-49b...|post|    더 뉴 그랜저ig 가성비 미친 ...|3e01cfac-3e3f-4af...|      NULL|
|08f01004-a325-411...|post|          현시점 가성비 최고의 차?|7b94478f-5210-4c8...|      NULL|
|ea45cf8f-47a7-4ad...|post|          현시점 가성비 최고의 차?|c6678638-e342-465...|      NULL|
|9ac1ec70-ea26-4b2...|post|      그랜저 vs 제네시스 g80 주...|0fe30a65-f2aa-473...|      NULL|
|8c8921c7-1cc5-4a3...|post|     재형&하슬도 놀란 2025년형 ...|16f20b43-7f05-4ae...|      NULL|
|d8611927-26ad-453...|post|      그랜저 vs 제네시스 g80 주...|87838956-cbc5-4f5...|      NULL|
|ca9076a7-2a9f-445...|post|    더 뉴 그랜저ig 가성비 미친 ...|44f27b9c-60c2-418...|      NULL|
|595066f5-0d04-4b8...|post|          현시점 가성비 최고의 차?|83e4f815-4077-45d...|      NULL|
|b1e6ce4c-1a33-49b...|post|신형 그랜저 페이스리프트 예상도...|ffe90a5a-2982-491...|      NULL|
|942fa6e2-978a-4bd...|post|    80년대에 그랜저 타면 '진짜 ...|06ad9170-8395-457...|      NULL|
|de4a7951-da20-4c6...|post|그랜저에 팰리세이드 외관을 적용...|cda12dca-224c-4b1...|      NULL|
|293a1d61-a391-40a...|post|    80년대에 그랜저 타면 '진짜 ...|27c27a45-60cb-44b...|      NULL|
|df20fc6b-3d96-40b...|post|그랜저에 팰리세이드 외관을 적용...|72e45a22-12ec-4b9...|      NULL|
+--------------------+----+----------------------------------+--------------------+----------+

클러스터 상태 확인  
```bash  
aws emr describe-cluster --cluster-id "j-000000"   
```   
 
step 상태 확인  
```bash  
aws emr describe-step --cluster-id "j-000000" --step-id "s-0000000"  
```   


## 로컬에서 Spark 사용해서 s3 데이터 읽고 쓰기 
- hadoop-aws-3.2.4.jar, aws-java-sdk-bundle-1.11.901.jar 파일이 $SPARK_HOME/jars에 있어야 합니다.  

- test.py 코드로 결과를 볼 수 있습니다.  
```bash
spark-submit test.py s3a://the-all-new-bucket/싼타페/2025/01/raw_output    
```  